<!DOCTYPE html>
<html lang="tr" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio - Sofia V2</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    
    <!-- Custom Styles -->
    <style>
        :root {
            --primary: #F0B90B;
            --bg-dark: #0B0E11;
            --bg-card: #161A1E;
            --bg-hover: #1E2329;
            --text-primary: #EAECEF;
            --text-secondary: #848E9C;
            --green: #0ECB81;
            --red: #F6465D;
            --border: #2B3139;
        }
        
        body {
            background: var(--bg-dark);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            transition: all 0.2s ease;
        }
        
        .card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: var(--primary);
            color: var(--bg-dark);
            font-weight: 600;
            border-radius: 8px;
            padding: 8px 16px;
            transition: all 0.2s ease;
        }
        
        .btn-success {
            background: var(--green);
            color: white;
            font-weight: 600;
            border-radius: 8px;
            padding: 8px 16px;
        }
        
        .btn-danger {
            background: var(--red);
            color: white;
            font-weight: 600;
            border-radius: 8px;
            padding: 8px 16px;
        }
        
        .price-up { color: var(--green); }
        .price-down { color: var(--red); }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .animate-slide {
            animation: slideIn 0.5s ease;
        }
        
        .holding-row {
            background: var(--bg-dark);
            border-radius: 8px;
            transition: all 0.2s ease;
        }
        
        .holding-row:hover {
            background: var(--bg-hover);
            transform: translateX(5px);
        }
    </style>
</head>

<body class="h-full flex" x-data="{ 
    sidebarOpen: true,
    totalBalance: 487234.89,
    dailyPnl: 8432.12,
    holdings: [
        { symbol: 'BTC', name: 'Bitcoin', amount: 2.45, value: 166321.54, change: 4.5, icon: 'fab fa-bitcoin', color: 'text-orange-500' },
        { symbol: 'ETH', name: 'Ethereum', amount: 24.8, value: 85728.54, change: 6.2, icon: 'fab fa-ethereum', color: 'text-blue-500' },
        { symbol: 'SOL', name: 'Solana', amount: 450, value: 45234.00, change: -2.1, icon: 'fas fa-sun', color: 'text-purple-500' }
    ]
}">
    <!-- Sidebar -->
    <aside class="w-64 h-full" style="background: var(--bg-card); border-right: 1px solid var(--border);">
        <div class="p-4 border-b" style="border-color: var(--border);">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: var(--primary);">
                    <i class="fas fa-chart-line text-lg" style="color: var(--bg-dark);"></i>
                </div>
                <div>
                    <h1 class="text-lg font-bold">Sofia V2</h1>
                    <p class="text-xs" style="color: var(--text-secondary);">AI Trading Platform</p>
                </div>
            </div>
        </div>
        
        <nav class="p-3">
            <a href="/" class="flex items-center px-3 py-2.5 rounded-lg mb-1 hover:bg-gray-800" style="color: var(--text-secondary);">
                <i class="fas fa-th-large w-5"></i>
                <span class="ml-3">Dashboard</span>
            </a>
            <a href="/portfolio" class="flex items-center px-3 py-2.5 rounded-lg mb-1" style="background: rgba(240, 185, 11, 0.1); color: var(--primary);">
                <i class="fas fa-briefcase w-5"></i>
                <span class="ml-3">Portfolio</span>
            </a>
            <a href="/assets/BTC-USD" class="flex items-center px-3 py-2.5 rounded-lg mb-1 hover:bg-gray-800" style="color: var(--text-secondary);">
                <i class="fas fa-coins w-5"></i>
                <span class="ml-3">Markets</span>
            </a>
            <a href="/backtest" class="flex items-center px-3 py-2.5 rounded-lg mb-1 hover:bg-gray-800" style="color: var(--text-secondary);">
                <i class="fas fa-flask w-5"></i>
                <span class="ml-3">Backtest</span>
            </a>
            <a href="/strategies" class="flex items-center px-3 py-2.5 rounded-lg mb-1 hover:bg-gray-800" style="color: var(--text-secondary);">
                <i class="fas fa-robot w-5"></i>
                <span class="ml-3">Strategies</span>
            </a>
        </nav>
    </aside>
    
    <!-- Main Content -->
    <div class="flex-1 flex flex-col">
        <!-- Top Bar -->
        <header class="h-16 px-6 flex items-center justify-between border-b" style="background: var(--bg-card); border-color: var(--border);">
            <h2 class="text-xl font-semibold">Portfolio Management</h2>
            <div class="flex items-center space-x-4">
                <button class="btn-primary text-sm">
                    <i class="fas fa-download mr-2"></i>Export
                </button>
                <button class="p-2 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-bell" style="color: var(--text-secondary);"></i>
                </button>
            </div>
        </header>
        
        <!-- Content -->
        <main class="flex-1 p-6 overflow-y-auto">
            <!-- Portfolio Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <!-- Total Value -->
                <div class="card p-5 animate-slide">
                    <div class="flex items-center justify-between mb-3">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: rgba(240, 185, 11, 0.1);">
                            <i class="fas fa-chart-pie" style="color: var(--primary);"></i>
                        </div>
                        <span class="text-xs" style="color: var(--green);">Updated 2s ago</span>
                    </div>
                    <p class="text-xs mb-1" style="color: var(--text-secondary);">Portfolio Value</p>
                    <h3 class="text-2xl font-bold mb-1" x-text="'$' + totalBalance.toLocaleString()"></h3>
                    <span class="text-sm price-up">+24.8% All time</span>
                </div>
                
                <!-- Available Balance -->
                <div class="card p-5 animate-slide" style="animation-delay: 0.1s;">
                    <div class="flex items-center justify-between mb-3">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: rgba(14, 203, 129, 0.1);">
                            <i class="fas fa-dollar-sign" style="color: var(--green);"></i>
                        </div>
                        <div class="w-2 h-2 rounded-full" style="background: var(--green); animation: pulse 2s infinite;"></div>
                    </div>
                    <p class="text-xs mb-1" style="color: var(--text-secondary);">Available</p>
                    <h3 class="text-2xl font-bold mb-1">$45,678.32</h3>
                    <button class="text-sm" style="color: var(--primary);">
                        <i class="fas fa-plus mr-1"></i>Deposit
                    </button>
                </div>
                
                <!-- Today's Profit -->
                <div class="card p-5 animate-slide" style="animation-delay: 0.2s;">
                    <div class="flex items-center justify-between mb-3">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: rgba(240, 185, 11, 0.1);">
                            <i class="fas fa-fire" style="color: var(--primary);"></i>
                        </div>
                    </div>
                    <p class="text-xs mb-1" style="color: var(--text-secondary);">Today's Profit</p>
                    <h3 class="text-2xl font-bold mb-1 price-up" x-text="'+$' + dailyPnl.toLocaleString()"></h3>
                    <div class="h-1 rounded-full overflow-hidden" style="background: var(--bg-dark);">
                        <div class="h-full rounded-full" style="width: 78%; background: var(--green);"></div>
                    </div>
                </div>
                
                <!-- ROI -->
                <div class="card p-5 animate-slide" style="animation-delay: 0.3s;">
                    <div class="flex items-center justify-between mb-3">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: rgba(168, 85, 247, 0.1);">
                            <i class="fas fa-percentage text-purple-500"></i>
                        </div>
                    </div>
                    <p class="text-xs mb-1" style="color: var(--text-secondary);">Monthly ROI</p>
                    <h3 class="text-2xl font-bold mb-1">18.7%</h3>
                    <div class="flex items-center space-x-1">
                        <span class="text-xs price-up">3W</span>
                        <span class="text-xs price-down">1L</span>
                    </div>
                </div>
            </div>
            
            <!-- Main Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Holdings Section -->
                <div class="lg:col-span-2">
                    <!-- Holdings List -->
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold">Holdings</h3>
                            <div class="flex space-x-2">
                                <button class="px-3 py-1 text-xs rounded-md" style="background: var(--bg-hover);">
                                    <i class="fas fa-filter mr-1"></i>Filter
                                </button>
                                <button class="btn-primary text-xs">
                                    <i class="fas fa-plus mr-1"></i>Add Asset
                                </button>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <template x-for="holding in holdings" :key="holding.symbol">
                                <div class="holding-row p-4 flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 rounded-full flex items-center justify-center" 
                                             :style="'background: ' + (holding.symbol === 'BTC' ? 'rgba(251, 146, 60, 0.1)' : holding.symbol === 'ETH' ? 'rgba(59, 130, 246, 0.1)' : 'rgba(168, 85, 247, 0.1)')">
                                            <i :class="holding.icon + ' text-2xl ' + holding.color"></i>
                                        </div>
                                        <div>
                                            <p class="font-semibold" x-text="holding.name"></p>
                                            <p class="text-xs" style="color: var(--text-secondary);" x-text="holding.amount + ' ' + holding.symbol"></p>
                                        </div>
                                    </div>
                                    <div class="text-center">
                                        <p class="text-sm" style="color: var(--text-secondary);">Value</p>
                                        <p class="font-mono" x-text="'$' + holding.value.toLocaleString()"></p>
                                    </div>
                                    <div class="text-center">
                                        <p class="text-sm" style="color: var(--text-secondary);">24h</p>
                                        <p :class="holding.change > 0 ? 'price-up' : 'price-down'" 
                                           x-text="(holding.change > 0 ? '+' : '') + holding.change + '%'"></p>
                                    </div>
                                    <div>
                                        <canvas :id="'chart-' + holding.symbol" width="80" height="40"></canvas>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button class="btn-success text-xs">Buy</button>
                                        <button class="btn-danger text-xs">Sell</button>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                    
                    <!-- Performance Chart -->
                    <div class="card p-6 mt-6">
                        <h3 class="text-lg font-semibold mb-4">Performance</h3>
                        <div id="performanceChart" style="height: 300px;"></div>
                    </div>
                </div>
                
                <!-- Right Sidebar -->
                <div>
                    <!-- Allocation Chart -->
                    <div class="card p-6 mb-6">
                        <h3 class="text-lg font-semibold mb-4">Allocation</h3>
                        <canvas id="allocationChart" height="200"></canvas>
                        <div class="mt-4 space-y-2">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 rounded-full mr-2" style="background: #f97316;"></div>
                                    <span class="text-sm">BTC</span>
                                </div>
                                <span class="text-sm font-semibold">45%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 rounded-full mr-2" style="background: #3b82f6;"></div>
                                    <span class="text-sm">ETH</span>
                                </div>
                                <span class="text-sm font-semibold">30%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 rounded-full mr-2" style="background: #a855f7;"></div>
                                    <span class="text-sm">Others</span>
                                </div>
                                <span class="text-sm font-semibold">25%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Trades -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold mb-4">Recent Trades</h3>
                        <div class="space-y-3" id="recentTrades">
                            <!-- Trades will be added dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script>
    // Allocation Chart
    const allocationCtx = document.getElementById('allocationChart').getContext('2d');
    new Chart(allocationCtx, {
        type: 'doughnut',
        data: {
            labels: ['BTC', 'ETH', 'SOL'],
            datasets: [{
                data: [45, 30, 25],
                backgroundColor: ['#f97316', '#3b82f6', '#a855f7'],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false }
            },
            cutout: '70%'
        }
    });
    
    // Performance Chart
    const performanceOptions = {
        series: [{
            name: 'Portfolio Value',
            data: Array.from({length: 30}, (_, i) => ({
                x: new Date(Date.now() - (29 - i) * 86400000),
                y: 400000 + Math.sin(i * 0.3) * 20000 + Math.random() * 10000
            }))
        }],
        chart: {
            type: 'area',
            height: 300,
            toolbar: { show: false },
            background: 'transparent'
        },
        colors: ['#F0B90B'],
        fill: {
            type: 'gradient',
            gradient: {
                shadeIntensity: 1,
                opacityFrom: 0.4,
                opacityTo: 0
            }
        },
        stroke: { curve: 'smooth', width: 2 },
        grid: {
            borderColor: '#2B3139',
            strokeDashArray: 4
        },
        xaxis: {
            type: 'datetime',
            labels: { style: { colors: '#848E9C' } }
        },
        yaxis: {
            labels: {
                style: { colors: '#848E9C' },
                formatter: (val) => '$' + (val / 1000).toFixed(0) + 'k'
            }
        },
        tooltip: { theme: 'dark' }
    };
    
    const performanceChart = new ApexCharts(document.querySelector("#performanceChart"), performanceOptions);
    performanceChart.render();
    
    // Mini Charts for Holdings
    setTimeout(() => {
        ['BTC', 'ETH', 'SOL'].forEach(symbol => {
            const canvas = document.getElementById('chart-' + symbol);
            if (canvas) {
                const ctx = canvas.getContext('2d');
                const gradient = ctx.createLinearGradient(0, 0, 0, 40);
                gradient.addColorStop(0, symbol === 'SOL' ? 'rgba(246, 70, 93, 0.3)' : 'rgba(14, 203, 129, 0.3)');
                gradient.addColorStop(1, 'transparent');
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 10}, (_, i) => i),
                        datasets: [{
                            data: Array.from({length: 10}, () => Math.random() * 10 + 90),
                            borderColor: symbol === 'SOL' ? '#F6465D' : '#0ECB81',
                            backgroundColor: gradient,
                            borderWidth: 1.5,
                            tension: 0.4,
                            pointRadius: 0,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: false,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false }, tooltip: { enabled: false } },
                        scales: { x: { display: false }, y: { display: false } }
                    }
                });
            }
        });
    }, 100);
    
    // Simulate Live Trades
    function addTrade() {
        const trades = [
            { type: 'buy', asset: 'BTC', amount: '0.05', time: 'Just now' },
            { type: 'sell', asset: 'ETH', amount: '2.3', time: '2 min ago' },
            { type: 'buy', asset: 'SOL', amount: '45', time: '5 min ago' }
        ];
        
        const trade = trades[Math.floor(Math.random() * trades.length)];
        const tradesContainer = document.getElementById('recentTrades');
        
        const tradeElement = document.createElement('div');
        tradeElement.className = 'flex items-center justify-between animate-slide';
        tradeElement.innerHTML = `
            <div class="flex items-center space-x-3">
                <div class="w-8 h-8 rounded-full flex items-center justify-center" 
                     style="background: ${trade.type === 'buy' ? 'rgba(14, 203, 129, 0.1)' : 'rgba(246, 70, 93, 0.1)'};">
                    <i class="fas fa-arrow-${trade.type === 'buy' ? 'up' : 'down'} text-xs" 
                       style="color: ${trade.type === 'buy' ? 'var(--green)' : 'var(--red)'};"></i>
                </div>
                <div>
                    <p class="text-sm">${trade.type === 'buy' ? 'Buy' : 'Sell'} ${trade.asset}</p>
                    <p class="text-xs" style="color: var(--text-secondary);">${trade.time}</p>
                </div>
            </div>
            <span class="text-sm ${trade.type === 'buy' ? 'price-up' : 'price-down'}">
                ${trade.type === 'buy' ? '+' : '-'}${trade.amount}
            </span>
        `;
        
        tradesContainer.insertBefore(tradeElement, tradesContainer.firstChild);
        if (tradesContainer.children.length > 5) {
            tradesContainer.removeChild(tradesContainer.lastChild);
        }
    }
    
    // Initial trades
    for (let i = 0; i < 3; i++) addTrade();
    
    // Add new trade every 5 seconds
    setInterval(addTrade, 5000);
    
    // Animate balance updates
    setInterval(() => {
        const balanceChange = (Math.random() - 0.5) * 1000;
        Alpine.store('totalBalance', (prev) => prev + balanceChange);
    }, 3000);
    </script>
</body>
</html>